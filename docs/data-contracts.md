# Data Contracts

All models are defined in the Prisma schema at `apps/aze-api/prisma/schema.prisma`. The generated Prisma client is output to `apps/aze-api/generated/prisma/`.

---

## Database Models

### User

```
NAME:     User
LOCATION: apps/aze-api/prisma/schema.prisma

FIELDS:
- id          String    required  UUID v7, primary key
- email       String    required  unique
- name        String    optional
- password    String    required  plain text (no hashing)
- createdAt   DateTime  required  auto-set on create
- updatedAt   DateTime  required  auto-updated
```

---

### ProductCategory

```
NAME:     ProductCategory
LOCATION: apps/aze-api/prisma/schema.prisma

FIELDS:
- id        Int       required  auto-increment, primary key
- name      String    required  unique
- products  Product[] optional  one-to-many relation (back-reference)
```

---

### Product

```
NAME:     Product
LOCATION: apps/aze-api/prisma/schema.prisma

FIELDS:
- id          String          required  UUID v7, primary key
- name        String          required
- description String          optional
- price       Float           required
- categoryId  Int             required  foreign key → ProductCategory.id
- category    ProductCategory required  relation
- reviews     Review[]        optional  one-to-many relation
- tags        Tag[]           optional  many-to-many relation
- createdAt   DateTime        required  auto-set on create
- updatedAt   DateTime        required  auto-updated
```

---

### Review

```
NAME:     Review
LOCATION: apps/aze-api/prisma/schema.prisma

FIELDS:
- id        String   required  UUID v7, primary key
- rating    Int      required
- comment   String   optional
- productId String   required  foreign key → Product.id
- product   Product  required  relation
- createdAt DateTime required  auto-set on create
```

---

### Tag

```
NAME:     Tag
LOCATION: apps/aze-api/prisma/schema.prisma

FIELDS:
- id       String    required  UUID v7, primary key
- name     String    required  unique
- products Product[] optional  many-to-many relation
```

---

## Runtime Data Structures

### AuthInput

```
NAME:     AuthInput
LOCATION: apps/aze-api/src/auth/auth.service.ts

FIELDS:
- email     string  required
- password  string  required
```

### SignInData

```
NAME:     SignInData
LOCATION: apps/aze-api/src/auth/auth.service.ts

FIELDS:
- userId  string  required
- email   string  required
```

### AuthResult

```
NAME:     AuthResult
LOCATION: apps/aze-api/src/auth/auth.service.ts

FIELDS:
- userId       string  required
- email        string  required
- accessToken  string  required  JWT bearer token
```

### JWT Payload

```
NAME:     JWT Payload (signed by JwtService)
LOCATION: apps/aze-api/src/auth/auth.service.ts

FIELDS:
- email  string  required  user email
- sub    string  required  userId
```

### ApiData (Frontend)

```
NAME:     ApiData
LOCATION: apps/aze-client/src/components/MyComponent.tsx

FIELDS:
- id     number  required
- name   string  required
- price  number  required
```

### PrismaFilter Error Response

```
NAME:     PrismaFilter HTTP Error Response
LOCATION: apps/aze-api/src/config/filter/prisma.filter.ts

FIELDS:
- statusCode  number  required  HTTP status code
- timestamp   string  required  ISO 8601 datetime string
- path        string  required  request URL
- message     string  required  error description
```

---

## Prisma Input Types (used as request bodies)

These are generated by Prisma from the schema. Controllers use them directly as `@Body()` types.

| Controller | Method | Prisma Input Type |
|---|---|---|
| UsersController | POST | `Prisma.UserCreateInput` |
| UsersController | PATCH | `Prisma.UserUpdateInput` |
| ProductsController | POST | `Prisma.ProductCreateInput` |
| ProductsController | PATCH | `Prisma.ProductUpdateInput` |
| ProductCategoryController | POST | `Prisma.ProductCreateInput` *(note: likely intended as ProductCategoryCreateInput)* |
| ProductCategoryController | PATCH | `Prisma.ProductCategoryUpdateInput` |
| ReviewController | POST | `Prisma.ReviewCreateInput` |
| ReviewController | PATCH | `Prisma.ReviewUpdateInput` |
| TagController | POST | `Prisma.TagCreateInput` |
| TagController | PATCH | `Prisma.TagUpdateInput` |
